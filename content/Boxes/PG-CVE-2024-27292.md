#cve-2024-27292 #docassemble #jinja

>[!code]- Find open ports (22, 80)
>![Pasted image 20240731043448](/Images/Pasted%20image%2020240731043448.png)
#### Foothold

>[!code]- Find an unauthenticated file inclusion vulnerability for port 80
>As per [this guide](https://tantosec.com/blog/docassemble/):
>
>![Pasted image 20240731043418](/Images/Pasted%20image%2020240731043418.png)
>
>We can also read the doc assemble config file:
>**192.168.201.94/interview?i=/usr/share/docassemble/config/config.yml**
>
>>[!code]- Screenshot
>>![Pasted image 20240731043945](/Images/Pasted%20image%2020240731043945.png)
>>![Pasted image 20240731044011](/Images/Pasted%20image%2020240731044011.png)
>>![Pasted image 20240731044033](/Images/Pasted%20image%2020240731044033.png)

>[!code]- Upload a malicious file which contains a reverse shell payload
>[This guide](https://tantosec.com/blog/docassemble/) also suggests how to upload a file containing an RCE payload.
>
>First we upload a file using file upload UI on the index page.
>
>![Pasted image 20240801054957](/Images/Pasted%20image%2020240801054957.png)
>
>Catch the request in Burp and edit it to contain a malicious payload. The payload forces the web app to render the payload using jinja (a python templating engine). I changed the **filename** from cow.jpeg to **cow.payload**.
>
>![Pasted image 20240801045643](/Images/Pasted%20image%2020240801045643.png)
>
>Once uploaded, we can see where it's being stored by hovering over the **cow.payload** link.
>
>![Pasted image 20240801045805](/Images/Pasted%20image%2020240801045805.png)
>
>It shows its recorded as file **6**.
>
>![Pasted image 20240801045820](/Images/Pasted%20image%2020240801045820.png)
>
>[The same guide](https://tantosec.com/blog/docassemble/) suggests the absolute file path for the file on the server will therefore be **/usr/share/docassemble/files/000/000/000/006/file.payload**. Notably, the filename (before the file extension) is always changed to **file**. So, **cow.payload** will be stored as **file.payload**.
#### Access

>[!code]- Load the uploaded file and catch the reverse shell
>Visiting **192.168.199.94/interview?i=/usr/share/docassemble/files/000/000/000/006/file.payload** causes our malicious file to execute, and we can catch the reverse shell.
>
>![Pasted image 20240801045938](/Images/Pasted%20image%2020240801045938.png)

>[!success]- Obtain proof.txt
>We are **www-data** user but that doesn't matter as the flag is in the */* directory and readable by anyone.
>![Pasted image 20240801054732](/Images/Pasted%20image%2020240801054732.png)

